Scenario 2 â€“ Failed Authentication (Local)
Objective

Observe and analyze a failed local authentication attempt generated by an interactive user and how it is detected and logged by the SIEM.

Environment

Windows 11 endpoint (real system)

Wazuh SIEM

Sysmon enabled

Windows Security logs collected

Planned Activity

A failed authentication attempt is generated using the runas command with a non-existent user account.

The goal is to trigger a failed logon event (Event ID 4625) without escalating privileges or performing brute-force activity.

Activity Performed

From an interactive user session, the following command was executed:

runas /user:testuser cmd


An incorrect password was intentionally provided.

Due to the behavior of the runas utility, the command prompt closes immediately after the failed attempt, and no visible error message is displayed to the user.

Expected Outcome

Windows Security Event ID 4625 (An account failed to log on)

Event collected and visible in Wazuh

Identification of:

Target user

Logon type

Failure reason

Source process

Detection

The Wazuh SIEM detected a failed authentication attempt on endpoint ALEXD.

The event was generated by the Windows Security log and successfully ingested by Wazuh.

Alert Details

Event ID: 4625

Target user: testuser

Initiating user: Alex-D\dance

Logon type: 2 (Interactive)

Authentication package: Negotiate

Process involved: svchost.exe

Source: Local system

Analysis

This activity represents a failed local authentication attempt initiated from an interactive user session.

Although the attempt was manually generated for testing purposes, similar behavior is commonly observed during:

Credential guessing

User enumeration

Early attacker reconnaissance

No repeated attempts, privilege escalation, or lateral movement was observed.

The behavior was limited to a single failed logon event.

Limitations Observed

The runas command does not display a visible error message after a failed authentication attempt, as the process terminates immediately.

As a result, confirmation of the failed authentication relies entirely on log analysis, not endpoint output.

Conclusion

The alert was classified as benign but relevant.

While the activity does not indicate malicious intent on its own, failed authentication events should be correlated with:

Frequency

Source

Subsequent activity

to determine potential abuse or attack patterns.
